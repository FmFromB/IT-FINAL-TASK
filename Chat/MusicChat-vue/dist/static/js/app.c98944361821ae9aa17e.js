webpackJsonp([0],{A43G:function(t,e){},E51W:function(t,e){},GWga:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var r=a("VU/8")({name:"App",created:function(){}},s,!1,function(t){a("GWga")},null,null).exports,n=a("/ocq"),i=a("LlRI"),u=a.n(i),l={name:"AddUsers",props:{room:""},data:function(){return{options:"",list:""}},created:function(){this.loadUsers()},methods:{loadUsers:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/users/",type:"GET",success:function(e){t.list=e.data}})},addUser:function(){u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/users/",type:"POST",data:{room:this.room,user:parseInt(this.options)},success:function(t){alert("Пользователь добален")},error:function(t){alert("Ошибка")}})}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-col",[a("mu-row",[a("mu-button",{staticClass:"btn-send",attrs:{round:"",color:"primary"},on:{click:t.addUser}},[t._v("Добавить пользователя")])],1),t._v(" "),a("mu-col",{staticClass:"select",attrs:{span:"12",lg:"5",sm:"5"}},[a("mu-select",{attrs:{label:"Выберите пользователя",filterable:"","full-width":""},model:{value:t.options,callback:function(e){t.options=e},expression:"options"}},t._l(t.list,function(e){return a("mu-option",{key:t.city,attrs:{value:e.id}},[t._v("\n        "+t._s(e.attributes.username)+"\n      ")])}),1)],1)],1)},staticRenderFns:[]};var m={name:"Dialog",props:{id:""},components:{AddUsers:a("VU/8")(l,c,!1,function(t){a("PXtx")},"data-v-5523a610",null).exports},data:function(){return{dialogs:"",textarea:""}},created:function(){var t=this;u.a.ajaxSetup({headers:{Authorization:"Token "+sessionStorage.getItem("auth_token")}}),this.loadDialog(),setInterval(function(){t.loadDialog()},5e3)},methods:{loadDialog:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/chat/",type:"GET",data:{room:this.id},success:function(e){t.dialogs=e.data.data}})},sendMessage:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/chat/",type:"POST",data:{room:this.id,text:this.textarea},success:function(e){t.loadDialog()},error:function(t){alert(t.statusText)}})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-col",{attrs:{span:"8"}},[a("mu-container",{staticClass:"dialog"},t._l(t.dialogs,function(e){return a("mu-row",{attrs:{direction:"column","justify-content":"start","align-items":"end"}},[a("p",[a("strong",[t._v(t._s(e.user.username))])]),t._v(" "),a("p",[t._v(t._s(e.text))]),t._v(" "),a("span",[t._v(t._s(e.date))])])}),1),t._v(" "),a("mu-container",{staticClass:"message"},[a("mu-row",[a("mu-text-field",{attrs:{placeholder:"сообщение","full-width":""},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),t._v(" "),a("mu-button",{attrs:{round:"",color:"primary"},on:{click:t.sendMessage}},[t._v("Отправить")]),t._v(" "),a("AddUsers",{staticClass:"adduser",attrs:{room:t.id}})],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(m,d,!1,function(t){a("fR3x")},"data-v-7b7c0579",null).exports,f={name:"Room",components:{Dialog:p},data:function(){return{rooms:""}},created:function(){u.a.ajaxSetup({headers:{Authorization:"Token "+sessionStorage.getItem("auth_token")}}),this.loadRoom()},methods:{loadRoom:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/room/",type:"GET",success:function(e){t.rooms=e.data.data}})},openDialog:function(t){this.$emit("openDialog",t)},AddRoom:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/api/v1/chat/room/",type:"POST",success:function(e){t.loadRoom()},error:function(t){alert(t.statusText)}})}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-col",{staticClass:"rooms_list",attrs:{span:"4",sm:"3"}},[a("mu-button",{on:{click:t.AddRoom}},[t._v("Создать комнату")]),t._v(" "),t._l(t.rooms,function(e){return a("div",[a("h3",{on:{click:function(a){return t.openDialog(e.id)}}},[t._v(t._s(e.creator.username))]),t._v(" "),a("small",[t._v(t._s(e.date))])])})],2)},staticRenderFns:[]};var h={name:"Home",components:{Room:a("VU/8")(f,v,!1,function(t){a("ZRP4")},"data-v-becf4c78",null).exports,Dialog:p},data:function(){return{dialog:{id:"",show:!1}}},computed:{auth:function(){if(sessionStorage.getItem("auth_token"))return!0}},methods:{goLogin:function(){this.$router.push({name:"login"})},logout:function(){sessionStorage.removeItem("auth_token"),window.location="/"},goRegistrate:function(){this.$router.push({name:"reg"})},openDialog:function(t){this.dialog.id=t,this.dialog.show=!0}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-container",[a("mu-appbar",{staticClass:"bar",staticStyle:{width:"100%"},attrs:{color:"primary"}},[t._v("\n    ЫЫЫ\n    "),t.auth?t._e():a("mu-button",{attrs:{slot:"right",flat:""},on:{click:t.goLogin},slot:"right"},[t._v("Вход")]),t._v(" "),t.auth?a("mu-button",{attrs:{slot:"right",flat:""},on:{click:t.logout},slot:"right"},[t._v("Выход")]):a("mu-button",{attrs:{slot:"right",flat:""},on:{click:t.goRegistrate},slot:"right"},[t._v("Зарегистрироваться")])],1),t._v(" "),a("mu-row",[t.auth?a("h1",[t._v("Мои чаты")]):a("h1",[t._v("Приветствуем Вас в самой прогрессивной сети, чтобы оставлять сообщения необходимо войти")])]),t._v(" "),a("mu-row",[t.auth?a("Room",{on:{openDialog:t.openDialog}}):t._e(),t._v(" "),t.dialog.show?a("Dialog",{attrs:{id:t.dialog.id}}):t._e()],1)],1)},staticRenderFns:[]};var _=a("VU/8")(h,g,!1,function(t){a("A43G")},"data-v-826335bc",null).exports,w={name:"Login",data:function(){return{login:"",password:"",usernameRules:[{validate:function(t){return!!t},message:"Обязательное поле"}],passwordRules:[{validate:function(t){return!!t},message:"Вы не можете войти без пароля"}],validateForm:{username:"",password:""}}},methods:{submit:function(){this.$refs.form.validate().then(function(t){console.log("form valid: ",t)})},clear:function(){this.$refs.form.clear(),this.validateForm={username:"",password:"",isAgree:!1}},setLogin:function(){var t=this;u.a.ajax({url:"http://127.0.0.1:8000/auth/token/login/",type:"POST",data:{username:this.validateForm.username,password:this.validateForm.password},success:function(e){alert("Добро пожаловать"),sessionStorage.setItem("auth_token",e.data.attributes.auth_token),t.$router.push({name:"home"})},error:function(t){400===t.status&&alert("Логин или пароль неверен")}})},goHome:function(){this.$router.push({name:"home"})}}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-container",[a("mu-form",{ref:"form",staticClass:"mu-form",attrs:{model:t.validateForm}},[a("mu-form-item",{attrs:{label:"Имя пользователя (логин)",prop:"username",rules:t.usernameRules}},[a("mu-text-field",{attrs:{prop:"username"},model:{value:t.validateForm.username,callback:function(e){t.$set(t.validateForm,"username",e)},expression:"validateForm.username"}})],1),t._v(" "),a("mu-form-item",{attrs:{label:"Пароль",prop:"password",rules:t.passwordRules}},[a("mu-text-field",{attrs:{type:"password",prop:"password"},model:{value:t.validateForm.password,callback:function(e){t.$set(t.validateForm,"password",e)},expression:"validateForm.password"}})],1),t._v(" "),a("mu-form-item",[a("mu-button",{attrs:{color:"primary"},on:{click:t.setLogin}},[t._v("войти")]),t._v(" "),a("mu-button",{on:{click:t.clear}},[t._v("сбросить")]),t._v(" "),a("mu-button",{on:{click:t.goHome}},[t._v("на главную")])],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(w,x,!1,function(t){a("ldAb")},"data-v-a68c911e",null).exports,F={name:"Reg",data:function(){return{usernameRules:[{validate:function(t){return!!t},message:"Обязательное поле"},{validate:function(t){return t.length>=3},message:"Ваш логин не может быть короче 3 символов"}],passwordRules:[{validate:function(t){return!!t},message:"Обязательное поле"},{validate:function(t){return t.length>=3&&t.length<=10},message:"Пароль должен быть не короче 10 символов"}],validateForm:{username:"",password:"",confPassword:""}}},methods:{goHome:function(){this.$router.push({name:"home"})},clear:function(){this.$refs.form.clear(),this.validateForm={username:"",password:"",confPassword:""}},setReg:function(){var t=this;this.$refs.form.validate().then(function(t){console.log("form valid: ",t)}),u.a.ajax({url:"http://127.0.0.1:8000/auth/users/",type:"POST",data:{username:this.validateForm.username,password:this.validateForm.password,confPassword:this.validateForm.confPassword},success:function(e){alert("Спасибо за регистрацию"),t.$router.push({name:"home"})},error:function(t){400===t.status&&alert("Данные не корректны")}})}}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("mu-container",[a("mu-form",{ref:"form",staticClass:"mu-demo-form",attrs:{model:t.validateForm}},[a("mu-form-item",{attrs:{label:"Имя пользователя (логин)",prop:"username",rules:t.usernameRules}},[a("mu-text-field",{attrs:{prop:"username"},model:{value:t.validateForm.username,callback:function(e){t.$set(t.validateForm,"username",e)},expression:"validateForm.username"}})],1),t._v(" "),a("mu-form-item",{attrs:{label:"Пароль",prop:"password",rules:t.passwordRules}},[a("mu-text-field",{attrs:{type:"password",prop:"password"},model:{value:t.validateForm.password,callback:function(e){t.$set(t.validateForm,"password",e)},expression:"validateForm.password"}})],1),t._v(" "),a("mu-form-item",{attrs:{label:"Подтвердите пароль","help-text":"Убедитесь, что пароли совпадают",prop:"password",rules:t.passwordRules}},[a("mu-text-field",{attrs:{type:"password",prop:"password"},model:{value:t.validateForm.confPassword,callback:function(e){t.$set(t.validateForm,"confPassword",e)},expression:"validateForm.confPassword"}})],1),t._v(" "),a("mu-form-item",[a("mu-button",{attrs:{color:"primary"},on:{click:t.setReg}},[t._v("Зарегистрироваться")]),t._v(" "),a("mu-button",{on:{click:t.clear}},[t._v("Сбросить")]),t._v(" "),a("mu-button",{on:{click:t.goHome}},[t._v("на главную")])],1)],1)],1)},staticRenderFns:[]};var k=a("VU/8")(F,R,!1,function(t){a("lK0T")},"data-v-66f091ae",null).exports;o.a.use(n.a);var $=new n.a({routes:[{path:"/",name:"home",component:_},{path:"/login",name:"login",component:b},{path:"/reg",name:"reg",component:k}]}),y=a("aFc6");a("E51W");o.a.use(y.a),o.a.config.productionTip=!1,new o.a({el:"#app",router:$,components:{App:r},template:"<App/>"})},PXtx:function(t,e){},ZRP4:function(t,e){},fR3x:function(t,e){},lK0T:function(t,e){},ldAb:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.c98944361821ae9aa17e.js.map